#!/usr/bin/python

import threading
import socket
import subprocess

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
host = '0.0.0.0'
port = 4444
s.bind((host,port))

s.listen(5)

def handle_client(c):
  print 'Received connection'
  msg, addr = c.recvfrom(4096)
  print msg
  p = subprocess.Popen(['./vuln'], stdin=subprocess.PIPE)
  p.communicate(input=msg)[0]
  c.close()
  return

while True:
  c,a = s.accept()
  print a
  t = threading.Thread(target=handle_client, args=(c,))
  t.start()

